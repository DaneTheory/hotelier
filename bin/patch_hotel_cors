#!/bin/sh

#cat bin/patch_hotel_cors.patch
hotel_bin=`which hotel`
hotelSrcDir=`dirname $hotel_bin`
hotelSrcDir=`dirname $hotelSrcDir`
hotelSrcFile="$hotelSrcDir/lib/node_modules/hotel/lib/daemon/routers/api/events.js"
echo "Patching $hotelSrcFile"
patch $hotelSrcFile bin/patch_hotel_cors.patch

if [ $? -ne 0]; then
  echo 'Patching failed. Please change the file manually according to the README.md'
else
  echo 'Patching successful. Restarting hotel...'
  hotel stop && hotel start
fi
